{"openapi":"3.0.1","info":{"title":"Mianshiyuan API","description":"面试猿后端接口文档","contact":{"name":"Team","email":"team@example.com"},"license":{"name":"MIT"},"version":"v1.0.0"},"externalDocs":{"description":"Project README"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"tags":[{"name":"文件上传接口","description":"获取STS临时凭证，前端直传OSS"},{"name":"评论接口","description":"评论相关接口"},{"name":"agent接口","description":"完成系统agent对话功能"},{"name":"题目接口","description":"题目的增改查及绑定功能"},{"name":"题库接口","description":"题库的增、改、查功能"},{"name":"认证接口","description":"注册、登录、刷新、退出、当前用户"}],"paths":{"/api/question/{id}":{"get":{"tags":["题目接口"],"summary":"根据ID查询题目（无需登录）","operationId":"getQuestionById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseQuestionVO"}}}}}},"put":{"tags":["题目接口"],"summary":"更新题目（需要登录）","description":"仅题目创建者或管理员可以编辑，支持保存草稿与提交审核","operationId":"updateQuestion","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseQuestionVO"}}}}}}},"/api/bank/{id}":{"get":{"tags":["题库接口"],"summary":"根据ID查询题库（无需登录）","operationId":"getBankById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseBankVO"}}}}}},"put":{"tags":["题库接口"],"summary":"更新题库（需要管理员权限）","description":"任何状态的题库都可以更新。支持两种模式：1.保存草稿（submitForReview=false，状态=0） 2.提交审核（submitForReview=true，状态=1）","operationId":"updateBank","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BankUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseBankVO"}}}}}}},"/api/question":{"get":{"tags":["题目接口"],"summary":"分页查询题目列表（无需登录）","description":"支持按标题模糊搜索、按标签筛选、按难度筛选、按照题库id筛选","operationId":"listQuestions","parameters":[{"name":"pageRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/PageRequest"}},{"name":"queryRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/QuestionListRequest"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponsePageQuestionVO"}}}}}},"post":{"tags":["题目接口"],"summary":"创建题目（需要登录）","description":"支持保存草稿与提交审核两种模式，管理员提交将自动审核通过","operationId":"createQuestion","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionCreateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseQuestionVO"}}}}}}},"/api/question/bind":{"post":{"tags":["题目接口"],"summary":"批量绑定题目到题库（管理员）","description":"将题目批量加入题库，已存在的绑定会自动忽略","operationId":"bindQuestionsToBank","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuestionBatchBindRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseBoolean"}}}}}}},"/api/comment":{"post":{"tags":["评论接口"],"summary":"新增评论","description":"新增用户评论或回复","operationId":"addComment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddCommentRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseString"}}}}}}},"/api/bank":{"get":{"tags":["题库接口"],"summary":"分页查询题库列表（无需登录）","description":"支持按名称模糊搜索和按标签筛选","operationId":"listBanks","parameters":[{"name":"pageRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/PageRequest"}},{"name":"queryRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/BankListRequest"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponsePageBankVO"}}}}}},"post":{"tags":["题库接口"],"summary":"创建题库（需要管理员权限）","description":"支持两种模式：1.保存草稿（submitForReview=false，状态=0） 2.提交审核（submitForReview=true，状态=1）","operationId":"createBank","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BankCreateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseBankVO"}}}}}}},"/api/auth/register":{"post":{"tags":["认证接口"],"summary":"用户注册","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseUserVO"}}}}}}},"/api/auth/refresh":{"post":{"tags":["认证接口"],"summary":"刷新访问令牌","operationId":"refresh","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseTokenResponse"}}}}}}},"/api/auth/logout":{"post":{"tags":["认证接口"],"summary":"用户登出","operationId":"logout","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseVoid"}}}}}}},"/api/auth/login":{"post":{"tags":["认证接口"],"summary":"用户登录（返回JWT）","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseTokenResponse"}}}}}}},"/api/question/{questionId}/comments":{"get":{"tags":["题目接口"],"summary":"获取题目评论列表（需要登录）","description":"根据题目ID获取评论列表，支持嵌套回复结构","operationId":"getQuestionComments","parameters":[{"name":"questionId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseListCommentVO"}}}}}}},"/api/question/my":{"get":{"tags":["题目接口"],"summary":"分页查询我创建的题目（需要登录）","description":"分页展示当前用户创建的所有题目，无需任何参数","operationId":"listMyQuestions","parameters":[{"name":"pageRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/PageRequest"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponsePageQuestionVO"}}}}}}},"/api/question/catalog":{"get":{"tags":["题目接口"],"summary":"查询题库内题目目录（无需登录）","description":"传入题库ID，返回该题库下所有题目的ID及标题","operationId":"listQuestionCatalog","parameters":[{"name":"id","in":"query","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseListQuestionCatalogItemVO"}}}}}}},"/api/question/answer":{"get":{"tags":["题目接口"],"summary":"分页查询我回答的题目以及答案（需要登录）","description":"分页展示当前用户回答的所有题目和答案，无需任何参数","operationId":"listMyQuestionsAnswer","parameters":[{"name":"pageRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/PageRequest"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponsePageQuestionAnswerVO"}}}}}}},"/api/file/sts-credentials":{"get":{"tags":["文件上传接口"],"summary":"获取STS临时凭证（需要登录）","description":"获取STS临时凭证，用于前端直传OSS。返回临时AccessKey、Secret和SecurityToken","operationId":"getStsCredentials","parameters":[{"name":"folder","in":"query","required":false,"schema":{"type":"string","default":""}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseStsCredentialsVO"}}}}}}},"/api/file/sts-credentials/image":{"get":{"tags":["文件上传接口"],"summary":"获取图片上传STS临时凭证（需要登录）","description":"获取STS临时凭证，用于前端直传图片到OSS。自动保存到images文件夹","operationId":"getImageUploadCredentials","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseStsCredentialsVO"}}}}}}},"/api/bank/tags":{"get":{"tags":["题库接口"],"summary":"查询所有标签（无需登录）","description":"返回所有题库的标签列表，去重后按包含该标签的题库数量降序排列","operationId":"getAllTags","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseListString"}}}}}}},"/api/auth/me":{"get":{"tags":["认证接口"],"summary":"获取当前登录用户信息","operationId":"me","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseUserVO"}}}}}}},"/api/agent/question":{"get":{"tags":["agent接口"],"operationId":"getQuestion","parameters":[{"name":"questionGenerationRequest","in":"query","required":true,"schema":{"$ref":"#/components/schemas/QuestionGenerationRequest"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BaseResponseListQuestionCreateRequest"}}}}}}}},"components":{"schemas":{"QuestionUpdateRequest":{"required":["title"],"type":"object","properties":{"title":{"type":"string"},"description":{"type":"string"},"tagList":{"type":"array","items":{"type":"string"}},"answer":{"type":"string"},"difficulty":{"maximum":2,"minimum":0,"type":"integer","format":"int32"},"submitForReview":{"type":"boolean"}}},"BaseResponseQuestionVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/QuestionVO"}}},"QuestionVO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"},"description":{"type":"string"},"tagList":{"type":"array","items":{"type":"string"}},"answer":{"type":"string"},"difficulty":{"type":"integer","format":"int32"},"creatorId":{"type":"integer","format":"int64"},"status":{"type":"integer","format":"int32"},"isVipOnly":{"type":"integer","format":"int32"},"favoriteCount":{"type":"integer","format":"int32"},"viewCount":{"type":"integer","format":"int32"},"reviewId":{"type":"integer","format":"int64"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"BankUpdateRequest":{"required":["name"],"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"coverImage":{"type":"string"},"tagList":{"type":"array","items":{"type":"string"}},"submitForReview":{"type":"boolean"}}},"BankVO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"name":{"type":"string"},"description":{"type":"string"},"coverImage":{"type":"string"},"tagList":{"type":"array","items":{"type":"string"}},"creatorId":{"type":"integer","format":"int64"},"status":{"type":"integer","format":"int32"},"reviewId":{"type":"integer","format":"int64"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"BaseResponseBankVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/BankVO"}}},"QuestionCreateRequest":{"required":["title"],"type":"object","properties":{"title":{"type":"string"},"description":{"type":"string"},"tagList":{"type":"array","items":{"type":"string"}},"answer":{"type":"string"},"difficulty":{"maximum":2,"minimum":0,"type":"integer","format":"int32"},"submitForReview":{"type":"boolean"}}},"QuestionBatchBindRequest":{"required":["bankId","questionIdList"],"type":"object","properties":{"bankId":{"type":"integer","format":"int64"},"questionIdList":{"type":"array","items":{"type":"integer","format":"int64"}}}},"BaseResponseBoolean":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"boolean"}}},"AddCommentRequest":{"required":["commentType","content","questionId"],"type":"object","properties":{"questionId":{"type":"integer","format":"int64"},"parentId":{"type":"integer","format":"int64"},"commentType":{"type":"integer","format":"int32"},"content":{"maxLength":1000,"minLength":1,"type":"string"}}},"BaseResponseString":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"string"}}},"BankCreateRequest":{"required":["name"],"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"coverImage":{"type":"string"},"tagList":{"type":"array","items":{"type":"string"}},"submitForReview":{"type":"boolean"}}},"RegisterRequest":{"required":["password","username"],"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string"}}},"BaseResponseUserVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/UserVO"}}},"UserVO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"username":{"type":"string"},"avatarUrl":{"type":"string"},"role":{"type":"string","enum":["USER","ADMIN","REVIEWER"]},"email":{"type":"string"},"phone":{"type":"string"},"nickname":{"type":"string"}}},"BaseResponseTokenResponse":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/TokenResponse"}}},"TokenResponse":{"type":"object","properties":{"accessToken":{"type":"string"},"refreshToken":{"type":"string"}}},"BaseResponseVoid":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"object"}}},"LoginRequest":{"required":["password","username"],"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}}},"PageRequest":{"type":"object","properties":{"current":{"minimum":1,"type":"integer","format":"int64"},"size":{"maximum":100,"minimum":1,"type":"integer","format":"int64"}}},"QuestionListRequest":{"type":"object","properties":{"title":{"type":"string"},"tag":{"type":"string"},"difficulty":{"maximum":2,"minimum":0,"type":"integer","format":"int32"},"bankId":{"type":"integer","format":"int64"}}},"BaseResponsePageQuestionVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/PageQuestionVO"}}},"OrderItem":{"type":"object","properties":{"column":{"type":"string"},"asc":{"type":"boolean"}}},"PageQuestionVO":{"type":"object","properties":{"records":{"type":"array","items":{"$ref":"#/components/schemas/QuestionVO"}},"total":{"type":"integer","format":"int64"},"size":{"type":"integer","format":"int64"},"current":{"type":"integer","format":"int64"},"orders":{"type":"array","writeOnly":true,"items":{"$ref":"#/components/schemas/OrderItem"}},"optimizeCountSql":{"$ref":"#/components/schemas/PageQuestionVO"},"searchCount":{"$ref":"#/components/schemas/PageQuestionVO"},"optimizeJoinOfCountSql":{"type":"boolean","writeOnly":true},"maxLimit":{"type":"integer","format":"int64","writeOnly":true},"countId":{"type":"string","writeOnly":true},"pages":{"type":"integer","format":"int64","deprecated":true}}},"BaseResponseListCommentVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/CommentVO"}}}},"CommentVO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"questionId":{"type":"integer","format":"int64"},"userVO":{"$ref":"#/components/schemas/UserVO"},"parentId":{"type":"integer","format":"int64"},"commentType":{"type":"integer","format":"int32"},"content":{"type":"string"},"isPinned":{"type":"integer","format":"int32"},"likeCount":{"type":"integer","format":"int32"},"sortOrder":{"type":"integer","format":"int32"},"updatedAt":{"type":"string","format":"date-time"},"createdAt":{"type":"string","format":"date-time"}}},"BaseResponseListQuestionCatalogItemVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/QuestionCatalogItemVO"}}}},"QuestionCatalogItemVO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"}}},"AnswerRatingVO":{"type":"object","properties":{"answer":{"type":"string"},"feedback":{"type":"string"},"score":{"type":"number"},"createdAt":{"type":"string","format":"date-time"}}},"BaseResponsePageQuestionAnswerVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/PageQuestionAnswerVO"}}},"PageQuestionAnswerVO":{"type":"object","properties":{"records":{"type":"array","items":{"$ref":"#/components/schemas/QuestionAnswerVO"}},"total":{"type":"integer","format":"int64"},"size":{"type":"integer","format":"int64"},"current":{"type":"integer","format":"int64"},"orders":{"type":"array","writeOnly":true,"items":{"$ref":"#/components/schemas/OrderItem"}},"optimizeCountSql":{"$ref":"#/components/schemas/PageQuestionAnswerVO"},"searchCount":{"$ref":"#/components/schemas/PageQuestionAnswerVO"},"optimizeJoinOfCountSql":{"type":"boolean","writeOnly":true},"maxLimit":{"type":"integer","format":"int64","writeOnly":true},"countId":{"type":"string","writeOnly":true},"pages":{"type":"integer","format":"int64","deprecated":true}}},"QuestionAnswerVO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"},"answerRatingVOList":{"type":"array","items":{"$ref":"#/components/schemas/AnswerRatingVO"}}}},"BaseResponseStsCredentialsVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/StsCredentialsVO"}}},"StsCredentialsVO":{"type":"object","properties":{"accessKeyId":{"type":"string"},"accessKeySecret":{"type":"string"},"securityToken":{"type":"string"},"expiration":{"type":"string"},"ossHost":{"type":"string"},"region":{"type":"string"},"bucketName":{"type":"string"},"pathPrefix":{"type":"string"},"folder":{"type":"string"}}},"BankListRequest":{"type":"object","properties":{"name":{"type":"string"},"tag":{"type":"string"}}},"BaseResponsePageBankVO":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/PageBankVO"}}},"PageBankVO":{"type":"object","properties":{"records":{"type":"array","items":{"$ref":"#/components/schemas/BankVO"}},"total":{"type":"integer","format":"int64"},"size":{"type":"integer","format":"int64"},"current":{"type":"integer","format":"int64"},"orders":{"type":"array","writeOnly":true,"items":{"$ref":"#/components/schemas/OrderItem"}},"optimizeCountSql":{"$ref":"#/components/schemas/PageBankVO"},"searchCount":{"$ref":"#/components/schemas/PageBankVO"},"optimizeJoinOfCountSql":{"type":"boolean","writeOnly":true},"maxLimit":{"type":"integer","format":"int64","writeOnly":true},"countId":{"type":"string","writeOnly":true},"pages":{"type":"integer","format":"int64","deprecated":true}}},"BaseResponseListString":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"type":"string"}}}},"QuestionGenerationRequest":{"type":"object","properties":{"topic":{"type":"string"},"difficulty":{"type":"integer","format":"int32"},"count":{"type":"integer","format":"int32"}}},"BaseResponseListQuestionCreateRequest":{"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/QuestionCreateRequest"}}}}}}}